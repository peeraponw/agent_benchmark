# Security Guide: AI Agent Framework Comparison Project

## Overview

This guide provides essential security guidance for the AI Agent Framework Comparison Project, focusing on protecting sensitive configuration data, API keys, and preventing common security vulnerabilities.

## üîë Secret Management

### OpenRouter API Key Security

**Critical Security Requirements:**
- **Never commit API keys to version control**
- Store OpenRouter API keys in environment variables only
- Use different API keys for development and production
- Regularly rotate API keys (recommended: every 90 days)
- Monitor API key usage for unusual activity

**Secure Storage:**
```bash
# ‚úÖ CORRECT: Store in environment file
OPENROUTER_API_KEY=sk-or-v1-your-actual-key-here

# ‚ùå WRONG: Never hardcode in source code
api_key = "sk-or-v1-your-actual-key-here"  # DON'T DO THIS
```

### Langfuse Authentication Secrets

**Required Secrets:**
- `LANGFUSE_NEXTAUTH_SECRET`: Minimum 64 characters, high entropy
- `LANGFUSE_SALT`: Minimum 32 characters, hexadecimal format
- `LANGFUSE_PUBLIC_KEY`: Generated by Langfuse UI
- `LANGFUSE_SECRET_KEY`: Generated by Langfuse UI

**Generation:**
```bash
# Use the provided utility to generate secure secrets
uv run python scripts/generate_secrets.py --output-format env

# Or generate manually with OpenSSL
openssl rand -hex 32  # For LANGFUSE_SALT
openssl rand -base64 64  # For LANGFUSE_NEXTAUTH_SECRET
```

### Database Security

**Password Requirements:**
- Minimum 16 characters for development
- Minimum 32 characters for production
- Include uppercase, lowercase, numbers, and symbols
- Avoid dictionary words and common patterns

**Example Secure Configuration:**
```bash
POSTGRES_PASSWORD=Kj9#mN2$pQ8@vR5&wX7!zA3%cF6*hL1^
LANGFUSE_DB_PASSWORD=Tn4&yU8@bV2#kM9$sP6!qR3%wX7*zA5^
```

## üõ°Ô∏è Environment Configuration Security

### Environment File Protection

**File Permissions:**
```bash
# Set restrictive permissions on .env files
chmod 600 .env
chmod 600 */env

# Verify permissions
ls -la .env
# Should show: -rw------- (600)
```

**Git Protection:**
```bash
# Ensure .env files are in .gitignore
echo "*.env" >> .gitignore
echo ".env.*" >> .gitignore

# Check for accidentally committed secrets
git log --all --full-history -- "*.env"
```

### Template Security Enhancement

**Security Warnings in Templates:**
All `.env.template` files include security warnings:
```bash
# ============================================================================
# SECURITY WARNING: Replace ALL placeholder values before use
# ============================================================================
# - Generate secure secrets with: uv run python scripts/generate_secrets.py
# - Never use default/example values in production
# - Keep .env files out of version control
# - Use minimum 32-character secrets for authentication
```

## üö® Common Security Pitfalls

### 1. Default Values
**‚ùå Never use these in production:**
- `your_api_key_here`
- `your_secret_here`
- `password123`
- `admin`
- `changeme`

**‚úÖ Always replace with:**
- Generated secure random strings
- Unique values per environment
- Properly validated secrets

### 2. Weak Passwords
**‚ùå Avoid:**
- Short passwords (< 16 characters)
- Dictionary words
- Predictable patterns
- Reused passwords across services

**‚úÖ Use:**
- Generated random passwords
- High entropy strings
- Unique passwords per service
- Regular rotation schedule

### 3. Accidental Exposure
**‚ùå Common mistakes:**
- Committing .env files to Git
- Sharing secrets in chat/email
- Logging secrets in application logs
- Storing secrets in plain text files

**‚úÖ Best practices:**
- Use environment variables
- Implement secret scanning
- Regular security audits
- Encrypted storage for backups

## üîß Security Tools

### Secret Generation
```bash
# Generate all required secrets
uv run python scripts/generate_secrets.py

# Generate with specific format
uv run python scripts/generate_secrets.py --output-format json

# Save to file
uv run python scripts/generate_secrets.py --output-file secrets.env
```

### Secret Validation
```bash
# Validate current environment
uv run python scripts/validate_secrets.py

# Validate specific file
uv run python scripts/validate_secrets.py --env-file dspy/.env

# Strict validation mode
uv run python scripts/validate_secrets.py --strict
```

### Security Checklist
```bash
# Run complete security validation
uv run python scripts/validate_secrets.py --strict

# Check file permissions
find . -name "*.env" -exec ls -la {} \;

# Verify .gitignore protection
git check-ignore .env
```

## üîç Security Monitoring

### Regular Security Tasks

**Weekly:**
- [ ] Run secret validation on all environments
- [ ] Check for new .env files in Git history
- [ ] Review API key usage logs

**Monthly:**
- [ ] Rotate development API keys
- [ ] Update security documentation
- [ ] Review access permissions

**Quarterly:**
- [ ] Rotate production API keys
- [ ] Security audit of all configurations
- [ ] Update security tools and dependencies

### Incident Response

**If secrets are compromised:**
1. **Immediate:** Revoke/rotate affected keys
2. **Assess:** Determine scope of exposure
3. **Notify:** Inform relevant stakeholders
4. **Document:** Record incident and response
5. **Improve:** Update security measures

## üìã Security Standards Summary

### Minimum Requirements
- **Secret Length:** 32+ characters for authentication secrets
- **Character Diversity:** Include uppercase, lowercase, numbers, symbols
- **No Defaults:** Replace all placeholder values
- **File Permissions:** 600 for .env files
- **Git Protection:** All .env files in .gitignore

### Recommended Practices
- Use provided generation utilities
- Regular secret rotation
- Automated validation in CI/CD
- Security monitoring and alerting
- Documentation of security procedures

## üÜò Getting Help

### Security Issues
- **Critical:** Immediately revoke compromised secrets
- **Questions:** Consult this guide and project documentation
- **Updates:** Keep security tools and dependencies current

### Tools and Resources
- `scripts/generate_secrets.py` - Secure secret generation
- `scripts/validate_secrets.py` - Security validation
- OpenRouter security documentation
- Langfuse security best practices

---

**Remember:** Security is everyone's responsibility. When in doubt, choose the more secure option and ask for guidance.
